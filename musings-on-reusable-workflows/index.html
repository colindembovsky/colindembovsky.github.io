<!DOCTYPE html>
<html lang="en"><head><title>Musings on GitHub Actions Reusable Workflows | Colin’s ALM Corner</title><meta name="generator" content="Jekyll v3.9.0" /><meta property="og:title" content="Musings on GitHub Actions Reusable Workflows" /><meta name="author" content="Colin Dembovsky" /><meta property="og:locale" content="en" /><meta name="description" content="Newly released Reusable Workflows allows you to reuse workflows in your GitHub workflows. While this still has some limitations, it’s still better than copy/paste!" /><meta property="og:description" content="Newly released Reusable Workflows allows you to reuse workflows in your GitHub workflows. While this still has some limitations, it’s still better than copy/paste!" /><link rel="canonical" href="https://github.com/pages/colindembovsky/musings-on-reusable-workflows/" /><meta property="og:url" content="https://github.com/pages/colindembovsky/musings-on-reusable-workflows/" /><meta property="og:site_name" content="Colin’s ALM Corner" /><meta property="og:image" content="https://github.com/pages/colindembovsky/assets/images/2021/10/reuse.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-10-05T01:22:01+00:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://github.com/pages/colindembovsky/assets/images/2021/10/reuse.jpeg" /><meta property="twitter:title" content="Musings on GitHub Actions Reusable Workflows" /><meta name="twitter:site" content="@colindembovsky" /><meta name="twitter:creator" content="@colindembovsky" /> <script type="application/ld+json"> {"description":"Newly released Reusable Workflows allows you to reuse workflows in your GitHub workflows. While this still has some limitations, it’s still better than copy/paste!","url":"https://github.com/pages/colindembovsky/musings-on-reusable-workflows/","@type":"BlogPosting","headline":"Musings on GitHub Actions Reusable Workflows","dateModified":"2021-10-05T01:22:01+00:00","datePublished":"2021-10-05T01:22:01+00:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://github.com/pages/colindembovsky/assets/img/logo.png"},"name":"Colin Dembovsky"},"image":"https://github.com/pages/colindembovsky/assets/images/2021/10/reuse.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/pages/colindembovsky/musings-on-reusable-workflows/"},"author":{"@type":"Person","name":"Colin Dembovsky"},"@context":"https://schema.org"}</script><meta name="keywords" content="devops,github,actions,build,ci,cd"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Colin's ALM Corner"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="application-name" content="Colin's ALM Corner"><meta name="theme-color" content="rgb(5,19,24)"><meta name="generator" content="Hydejack v9.1.4" /><link rel="alternate" href="https://github.com/pages/colindembovsky/musings-on-reusable-workflows/" hreflang="en"><link type="application/atom+xml" rel="alternate" href="https://github.com/pages/colindembovsky/feed.xml" title="Colin's ALM Corner" /><link rel="shortcut icon" href="/pages/colindembovsky/assets/icons/favicon.ico"><link rel="apple-touch-icon" href="/pages/colindembovsky/assets/icons/icon-192x192.png"><link rel="manifest" href="/pages/colindembovsky/assets/site.webmanifest"><link rel="dns-prefetch" href="https://fonts.googleapis.com"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preload" href="/pages/colindembovsky/assets/img/swipe.svg" as="image" id="_hrefSwipeSVG"><link rel="dns-prefetch" href="/pages/colindembovsky/assets/js/search-worker-9.1.4.js" as="worker" id="_hrefSearch"> <script>!function(r,c){"use strict";function a(e,t,n,o){e.addEventListener?e.addEventListener(t,n,o):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}r.loadJS=function(e,t){var n=c.createElement("script");n.src=e,t&&a(n,"load",t,{once:!0});t=c.scripts[0];return t.parentNode.insertBefore(n,t),n},r._loaded=!1,r.loadJSDeferred=function(e,t){var n=c.createElement("script");function o(){r._loaded=!0,t&&a(n,"load",t,{once:!0});var e=c.scripts[0];e.parentNode.insertBefore(n,e)}return n.src=e,r._loaded?o():a(r,"load",o,{once:!0}),n},r.setRel=r.setRelStylesheet=function(e){a(c.getElementById(e),"load",function(){this.rel="stylesheet"},{once:!0})}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); !function(w) { w._baseURL = '/pages/colindembovsky/'; w._publicPath = '/pages/colindembovsky/assets/js/'; w._noPushState = false; w._noDrawer = false; w._noNavbar = false; w._noToc = false; w._noSearch = false; w._advertise = false; w._search = { DATA_URL: '/pages/colindembovsky/assets/sitedata.json?no-cache', STORAGE_KEY: 'mini-search/pages/colindembovsky/', INDEX_KEY: 'index--2021-11-18T20:23:33+00:00', }; w._clapButton = false; }(window);</script> <script async src="/pages/colindembovsky/assets/bower_components/MathJax/es5/tex-mml-chtml.js" id="_MathJax"></script> <!--[if gt IE 8]><!----><style id="_styleInline"> .clearfix,.sidebar-social::after{content:"";display:table;clear:both}.color-transition,body,p,hr,.hr,.hr-after::after,.hr-bottom,.message,.note-sm,.note,#markdown-toc,.navbar,.nav-btn-bar,.nav-btn,.content .avatar{transition:none}#_dark-mode{font-size:1.25rem}@media screen{body.light-mode{--body-color: #333;--body-bg: #fff;--border-color: #ebebeb;--gray: #777;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--inv-body-color: #ccc;--inv-body-bg: var(--dark-mode-body-bg)}body.light-mode .content{-webkit-font-smoothing:initial;-moz-osx-font-smoothing:initial}body.dark-mode{--body-color: #ccc;--body-bg: var(--dark-mode-body-bg);--border-color: var(--dark-mode-border-color);--gray: rgba(255,255,255,.5);--gray-bg: rgba(255,255,255,.033);--gray-text: rgba(255,255,255,.625);--menu-text: rgba(255,255,255,.25);--inv-body-color: #333;--inv-body-bg: #fff}body.dark-mode .content{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}}@media screen and (prefers-color-scheme: dark){body{--body-color: #ccc;--body-bg: var(--dark-mode-body-bg);--border-color: var(--dark-mode-border-color);--gray: rgba(255,255,255,.5);--gray-bg: rgba(255,255,255,.033);--gray-text: rgba(255,255,255,.625);--menu-text: rgba(255,255,255,.25);--inv-body-color: #333;--inv-body-bg: #fff}body .content{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.tippy-content{-webkit-font-smoothing:initial;-moz-osx-font-smoothing:initial}}html{--font-family: Noto Sans,Helvetica,Arial,sans-serif;--font-family-heading: Roboto Slab,Helvetica,Arial,sans-serif;--code-font-family: Fira Code,Menlo,Monaco,Consolas,monospace;--body-color: #333;--body-bg: #fff;--border-color: #ebebeb;--gray: #777;--gray-bg: rgba(0,0,0,0.025);--gray-text: #666;--menu-text: #bbb;--inv-body-color: #ccc;--inv-body-bg: var(--dark-mode-body-bg);--root-font-size: 15px;--root-font-size-medium: 16px;--root-font-size-large: 17px;--root-font-size-print: 8pt;--root-line-height: 1.75;--font-weight: 400;--font-weight-bold: 700;--font-weight-heading: 700;--content-width-5: 54rem;--content-margin-5: 4rem;--sidebar-width: 21rem;--half-content: 31rem;--break-point-3: 64em;--break-point-5: 86em;--break-point-dynamic: 1664px}html .content{-webkit-font-smoothing:initial;-moz-osx-font-smoothing:initial}*{box-sizing:border-box}html,body{margin:0;padding:0}html{font-family:var(--font-family);font-size:var(--root-font-size);line-height:var(--root-line-height)}body{color:var(--body-color);background-color:var(--body-bg);font-weight:var(--font-weight);overflow-y:scroll}.content img,.img,.content video,.video{max-width:100%;height:auto}.lead{margin-left:-1rem;margin-right:-1rem;margin-bottom:1.5rem}img.lead,video.lead{display:block;max-width:calc(100% + 2rem);width:calc(100% + 2rem);height:auto}.heading,.f1,h1,.h1,.f2,h2,.h2,.f3,h3,.h3,.f4,h4,.h4,.post-date,.sidebar-nav-item,.f5,h5,.h5,.f6,h6,.h6{font-family:var(--font-family-heading);font-weight:var(--font-weight-heading)}.f1,h1,.h1{font-size:2rem;line-height:1.3}.f2,h2,.h2{font-size:1.5rem;line-height:1.4}.f3,h3,.h3{font-size:1.2em;line-height:1.5}.f4,h4,.h4,.post-date,.sidebar-nav-item{font-size:1.08rem;line-height:1.6}.f5,h5,.h5{font-size:1.04rem;line-height:1.7}.f6,h6,.h6{font-size:1rem}.content h1>a,.content .h1>a{text-decoration:none;border-bottom:none}@media screen and (max-width: 42em){.content h1,.content .h1{font-size:1.7rem;line-height:1.35}}@media screen and (min-width: 86em){.content h1,.content .h1{font-size:2.4rem;line-height:1.25}}@media screen and (min-width: 1664px){body:not(.no-large-headings) .content h1,body:not(.no-large-headings) .content .h1{width:calc(100% + 50vw - 32rem);font-size:3rem;line-height:1.2}}@media screen and (min-width: 124em){body:not(.no-large-headings) .content h1,body:not(.no-large-headings) .content .h1{font-size:4rem;line-height:1.1}}h1,h2,h3,.h1,.h2,.h3{margin:4rem 0 1rem}h4,h5,h6,.h4,.post-date,.h5,.h6{margin:3rem 0 .5rem}p{margin-top:0;margin-bottom:1rem}p.lead{font-size:1.2em;margin-top:1.5rem;margin-bottom:1.5rem;padding:0 1rem}ul,ol,dl{margin-top:0;margin-bottom:1rem}ul,ol{padding-left:1.25rem}hr,.hr{border:0;margin:1rem 0;border-top:1px solid var(--border-color)}.hr-after::after{content:"";display:block;margin:1rem 0;border-top:1px solid var(--border-color)}.hr-bottom{border-bottom:1px solid var(--border-color);padding-bottom:.75rem;margin-bottom:1rem}.page{margin-bottom:3em}.page li+li{margin-top:.25rem}.page>header{position:relative;margin-bottom:1.5rem}@media screen and (min-width: 1664px){body:not(.no-third-column) .page>header>.lead+.note-sm,body:not(.no-third-column) .page>header>.lead+.note,body:not(.no-third-column) .page>header>.lead+#markdown-toc,body:not(.no-third-column) .page>header>a.no-hover+.note-sm,body:not(.no-third-column) .page>header>a.no-hover+.note,body:not(.no-third-column) .page>header>a.no-hover+#markdown-toc{position:absolute;right:-25rem;width:21rem;bottom:0;margin-bottom:0}}.page-title,.post-title{margin-top:0}.post-date{display:flex;justify-content:space-between;margin-top:-.6rem;height:2rem;margin-bottom:.85rem;color:var(--gray)}.post-date>.ellipsis,#breadcrumbs.post-date>ul{cursor:pointer}.post-date [class^="icon-"]{display:inline-block;font-size:smaller;margin-right:.25rem}.related-posts{padding-left:0;list-style:none;margin-bottom:2rem}.related-posts>li,.related-posts>li+li{margin-top:1rem}.message,.note-sm,.note,#markdown-toc{margin-bottom:1rem;padding:1rem;color:var(--gray-text);background-color:var(--gray-bg);margin-left:-1rem;margin-right:-1rem}.note-sm,.note,#markdown-toc{background:transparent;color:var(--body-color);font-size:smaller;border-left:1px solid var(--border-color);padding:1.2rem 1rem 0 1rem;margin:1rem -1rem;position:relative}.note-sm:before,.note:before,#markdown-toc:before{font-size:0.667rem;font-weight:bold;font-style:normal;letter-spacing:.025rem;text-transform:uppercase;color:var(--menu-text);position:absolute;top:0}.note-sm[title]:before,[title].note:before,[title]#markdown-toc:before{content:attr(title) !important}.note{font-size:1rem}@media screen{body::before{content:'';width:.5rem;background:var(--gray-bg);position:fixed;left:0;top:0;bottom:0}}@media (min-width: 64em){body::before{width:21rem}}@media (min-width: 1664px){body::before{width:calc(50% - 31rem)}}@media screen and (min-width: 42em){html{font-size:var(--root-font-size-medium)}}@media screen and (min-width: 124em){html{font-size:var(--root-font-size-large)}}#breadcrumbs>ul{height:1rem;margin:-1.5rem 0 .5rem;padding:0;font-size:.667rem;color:var(--menu-text);text-transform:uppercase;width:100%;list-style:none}#breadcrumbs>ul>li{display:inline}#breadcrumbs>ul>li a{color:var(--gray);text-decoration:none;border-bottom:none}.fl{float:left}.fr{float:right}.mb4{margin-bottom:4rem}.mb6{margin-bottom:6rem}.mt0{margin-top:0}.mt1{margin-top:1rem}.mt2{margin-top:2rem}.mt3{margin-top:3rem}.mt4{margin-top:4rem}.pb0{padding-bottom:0}.ml1{margin-left:1rem}.mr1{margin-right:1rem}.sixteen-nine{position:relative}.sixteen-nine::before{display:block;content:"";width:100%;padding-top:56.25%}.sixteen-nine>*{position:absolute;top:0;left:0;right:0;bottom:0}.sixteen-ten{position:relative}.sixteen-ten::before{display:block;content:"";width:100%;padding-top:62.5%}.sixteen-ten>*{position:absolute;top:0;left:0;right:0;bottom:0}.four-three{position:relative}.four-three::before{display:block;content:"";width:100%;padding-top:75%}.four-three>*{position:absolute;top:0;left:0;right:0;bottom:0}.sr-only{display:none}.larger{font-size:larger}.smaller{font-size:smaller}.clearfix,.sidebar-social::after{content:"";display:table;clear:both}.ellipsis,#breadcrumbs>ul{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.border{border:1px solid var(--border-color)}@media (min-width: 42em){.border-radius,.lead,.page .aspect-ratio.sixteen-nine.lead{border-radius:.5rem}}.fallback-img{background-position:center;background-repeat:no-repeat;background-image:url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjkwIiB2aWV3Qm94PSIwIDAgMTYwIDkwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxnIHRyYW5zZm9ybT0ibWF0cml4KDAuMDQ4ODI4LCAwLCAwLCAwLjA0Nzk5MSwgNTQuOTk5OTczLCAyMC40MjgxNDgpIj4KICAgIDxwYXRoIHN0eWxlPSJmaWxsOnJnYmEoMTI4LDEyOCwxMjgsLjMzKSIgZD0iTTk1OS44ODQgMTI4YzAuMDQwIDAuMDM0IDAuMDgyIDAuMDc2IDAuMTE2IDAuMTE2djc2Ny43N2MtMC4wMzQgMC4wNDAtMC4wNzYgMC4wODItMC4xMTYgMC4xMTZoLTg5NS43N2MtMC4wNDAtMC4wMzQtMC4wODItMC4wNzYtMC4xMTQtMC4xMTZ2LTc2Ny43NzJjMC4wMzQtMC4wNDAgMC4wNzYtMC4wODIgMC4xMTQtMC4xMTRoODk1Ljc3ek05NjAgNjRoLTg5NmMtMzUuMiAwLTY0IDI4LjgtNjQgNjR2NzY4YzAgMzUuMiAyOC44IDY0IDY0IDY0aDg5NmMzNS4yIDAgNjQtMjguOCA2NC02NHYtNzY4YzAtMzUuMi0yOC44LTY0LTY0LTY0djB6Ii8+CiAgICA8cGF0aCBzdHlsZT0iZmlsbDpyZ2JhKDEyOCwxMjgsMTI4LC4zMykiIGQ9Ik04MzIgMjg4YzAgNTMuMDIwLTQyLjk4IDk2LTk2IDk2cy05Ni00Mi45OC05Ni05NiA0Mi45OC05NiA5Ni05NiA5NiA0Mi45OCA5NiA5NnoiLz4KICAgIDxwYXRoIHN0eWxlPSJmaWxsOnJnYmEoMTI4LDEyOCwxMjgsLjMzKSIgZD0iTTg5NiA4MzJoLTc2OHYtMTI4bDIyNC0zODQgMjU2IDMyMGg2NGwyMjQtMTkyeiIvPgogIDwvZz4KPC9zdmc+")}hy-push-state a{color:var(--body-color)}@supports not ((text-decoration-thickness: initial) and (text-underline-offset: initial)){hy-push-state a{text-decoration:none;border-bottom:2px solid}}@supports (text-decoration-thickness: initial) and (text-underline-offset: initial){hy-push-state a{text-decoration-style:solid;text-underline-offset:.35rem;text-decoration-thickness:2px}}hy-push-state a.no-hover{border-bottom:none;text-decoration-thickness:unset;text-underline-offset:unset}.content a:not(.btn):not(.no-hover){border-color:var(--accent-color-faded)}@supports (text-decoration-thickness: initial) and (text-underline-offset: initial){.content a:not(.btn):not(.no-hover){text-decoration-color:var(--accent-color-faded)}}.content .aspect-ratio{overflow:hidden}.content .aspect-ratio img{margin:0;width:100%;height:100%;background-color:var(--gray-bg)}hy-drawer{width:100%;position:relative;overflow:hidden;display:block;z-index:4}@media screen and (min-width: 64em){hy-drawer{position:fixed;width:21rem;top:0;left:0;bottom:0;margin-left:0}hy-drawer.cover{position:relative;width:100%}}@media screen and (min-width: 1664px){hy-drawer{width:calc(50% - 31rem)}}.sidebar{position:relative;display:flex;justify-content:center;align-items:center;color:rgba(255,255,255,0.75);text-align:center;min-height:100vh}.sidebar.invert{color:rgba(32,32,32,0.75)}.sidebar a{color:#fff;border-bottom-color:rgba(255,255,255,0.2);text-decoration-color:rgba(255,255,255,0.2)}.sidebar.invert a{color:#222;border-bottom-color:rgba(32,32,32,0.2);text-decoration-color:rgba(32,32,32,0.2)}.sidebar-bg{position:absolute;top:0;left:calc(50% - 50vw);width:100vw;height:100%;background:#202020 center / cover}.sidebar-bg::after{content:"";position:absolute;top:0;left:0;bottom:0;right:0;background:rgba(0,0,0,0.05)}.sidebar-bg.sidebar-overlay::after{background:linear-gradient(to bottom, rgba(32,32,32,0) 0%, rgba(32,32,32,0.5) 50%, rgba(32,32,32,0) 100%)}.sidebar-sticky{position:relative;z-index:3;max-width:21rem;padding:1.5rem;contain:content}.sidebar-about .avatar{margin-bottom:1.5rem}.sidebar-about>a.sidebar-title{text-decoration:none}.sidebar-about>a.sidebar-title>h2{margin:0;padding-bottom:.5rem}.sidebar-about>a.sidebar-title::after{content:'';display:block;border-bottom:2px solid;margin:0 auto .5rem;width:4rem;border-color:rgba(255,255,255,0.2);transition:border-color 250ms}.sidebar-about>a.sidebar-title:hover::after{border-color:#fff;transition:border-color 50ms}.sidebar.invert .sidebar-about>a.sidebar-title::after{border-color:rgba(32,32,32,0.2)}.sidebar.invert .sidebar-about>a.sidebar-title:hover::after{border-color:#222}.sidebar-nav>ul{list-style:none;padding-left:0}.sidebar-nav-item{display:inline-block;margin-bottom:.5rem}@media (min-width: 64em){#_main.no-drawer #_menu{display:none}#_main.no-drawer .nav-btn-bar>:nth-child(2){border:none}}.sidebar-social>ul{display:inline-block;list-style:none;padding-left:0;margin-bottom:0}.sidebar-social>ul>li{float:left}.sidebar-social>ul>li>a{display:inline-block;text-align:center;font-size:1.4rem;width:3rem;height:4rem;padding:.5rem 0;line-height:3rem;text-decoration:none;border-bottom-width:2px;border-bottom-style:solid}.sidebar-social>ul li+li{margin-top:0}.fixed-common,.fixed-top,.fixed-bottom{position:fixed;left:0;width:100%;z-index:2}.fixed-top{top:0}.fixed-bottom{bottom:0}.navbar>.content{position:relative;padding-top:0;padding-bottom:0;min-height:0;max-height:5rem}.nav-btn-bar{margin:0 -1rem;background-color:white;background-color:var(--body-bg);height:5rem;display:flex;align-items:center;position:relative}.nav-btn-bar>:first-child,.nav-btn-bar>:last-child{border:none}.nav-btn{background:none;border:none;text-decoration:none;display:flex;align-items:center;justify-content:center;width:3.25rem;height:5rem;color:var(--menu-text);border-right:1px solid var(--border-color);border-left:1px solid var(--border-color);margin-left:-1px}#markdown-toc{margin:2rem -1rem 2rem calc(-1rem + 1px);padding-left:2.5rem;padding-bottom:.5rem}#markdown-toc:before{left:1rem}@media screen and (min-width: 1664px){body:not(.no-toc) #markdown-toc{position:absolute;z-index:4;width:20.5rem;right:0;margin:auto;overflow:auto}}@media screen and (min-width: 1664px){body.no-break-layout:not(.no-toc) #markdown-toc{width:calc(50% - 31rem)}}.content{margin-left:auto;margin-right:auto;padding:8rem 1rem 12rem}@media screen{.content{padding-left:1.5rem;min-height:100vh}}@media screen and (min-width: 42em){.content{max-width:42rem}}@media screen and (min-width: 54em){.content{max-width:48rem}}@media screen and (min-width: 64em){.content{padding-left:1rem;margin-left:24rem;margin-right:3rem}}@media screen and (min-width: 86em){.content{padding-top:9rem;margin-left:25rem;margin-right:4rem;max-width:54rem}}@media screen and (min-width: 1664px){.content{margin:auto}}.large-only{display:none}@media screen and (min-width: 1664px){.large-only{display:block}}.avatar{width:7rem;height:7rem;border-radius:100%;overflow:hidden;display:inline-block}.avatar img{width:100%}.content .avatar{float:right;box-sizing:content-box;border:1rem solid var(--body-bg);transition:border-color 1s ease;margin-top:-1.5rem;margin-right:-1rem}hr.dingbat{display:none}.center-image{margin:auto;display:block}.note:before{content:"Note"}.page>header>.note-sm:before,.page>header>.note:before,.page>header>#markdown-toc:before{content:"Description"}#markdown-toc:before{content:"Table of Contents"}.layout-resume .note-sm:before,.layout-resume .note:before,.layout-resume #markdown-toc:before{content:"Summary"} .clearfix,main:not(.layout-resume) .columns::after{content:"";display:table;clear:both}.color-transition,main:not(.layout-resume) .project-card{transition:none}main:not(.layout-resume) .columns{margin-left:-1rem;display:flex;flex-wrap:wrap;contain:content;padding-top:1rem;margin-top:1rem;padding-right:1rem;margin-right:-1rem}main:not(.layout-resume) .column{float:left;padding-left:1rem;margin-bottom:2rem;width:100%;display:flex}@media screen and (min-width: 42em){main:not(.layout-resume) .columns{margin-left:-2rem;margin-right:-2rem}main:not(.layout-resume) .column-1-2{width:50%}}@media screen and (min-width: 1664px){main:not(.layout-resume) .columns-break{width:calc(50vw + 25rem)}main:not(.layout-resume) .columns-break>.column-1-2,main:not(.layout-resume) .columns-break>.column-1{width:27.5rem}}@media print{main:not(.layout-resume) .columns{display:block}main:not(.layout-resume) .column{display:block;width:50%}}main:not(.layout-resume) .project-card{width:100%;color:var(--gray-text);background-color:var(--gray-bg);padding-bottom:1rem;position:relative;overflow:hidden;box-shadow:0.125rem 0.125rem 1rem rgba(0,0,0,0.2);contain:content;border-radius:.5rem;page-break-inside:avoid;transition:transform 500ms ease;will-change:transform}main:not(.layout-resume) .project-card:hover{transform:translateY(-0.25rem);transition:transform 250ms ease}main:not(.layout-resume) .project-card>a.flip-project{display:block}main:not(.layout-resume) .project-card>a.flip-project .project-card-img{margin-bottom:0}main:not(.layout-resume) .project-card>a.flip-project .project-card-img img{display:block;border-top-left-radius:.5rem;border-top-right-radius:.5rem}main:not(.layout-resume) .project-card a{position:relative;z-index:1}main:not(.layout-resume) .project-card a.fill-card{position:absolute;top:0;left:0;right:0;bottom:0;z-index:0}main:not(.layout-resume) .project-card>.project-card-title,main:not(.layout-resume) .project-card>.project-card-text{text-align:center;padding:0 1rem}main:not(.layout-resume) .project-card>.project-card-title{display:block;font-size:1.08rem;margin-top:.75rem;margin-bottom:.25rem;color:inherit}main:not(.layout-resume) .project-card>.project-card-text{margin:.25rem 0}main:not(.layout-resume) .column-1>.project-card>.project-card-title{font-size:1.2rem}main:not(.layout-resume) .column-1>.project-card>.project-card-text{font-size:1rem}</style><link rel="preload" as="style" href="/pages/colindembovsky/assets/css/hydejack-9.1.4.css" id="_stylePreload"><link rel="preload" as="style" href="/pages/colindembovsky/assets/icomoon/style.css" id="_iconsPreload"><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap" id="_fontsPreload"> <script> setRel('_stylePreload'); setRel('_iconsPreload'); /**/setRel('_fontsPreload');/**/ </script> <noscript><link rel="stylesheet" href="/pages/colindembovsky/assets/css/hydejack-9.1.4.css"><link rel="stylesheet" href="/pages/colindembovsky/assets/icomoon/style.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700%7CNoto+Sans:400,400i,700,700i&display=swap"> </noscript><style id="_pageStyle"> html{--accent-color: rgb(79, 129, 220);--accent-color-faded: rgba(79,129,220,0.5);--accent-color-highlight: rgba(79,129,220,0.1);--accent-color-darkened: #2f6ad6;--theme-color: rgb(5,19,24);--dark-mode-body-bg: #292e30;--dark-mode-border-color: #353c3e}</style><!--<![endif]--> <script async src="https://www.googletagmanager.com/gtag/js?id=G-FD31RTDXK2"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-FD31RTDXK2'); </script><body class="no-break-layout"> <script> window._sunrise = 6; window._sunset = 18; !function(e,s){var d="light-mode",o="dark-mode",a=(new Date).getHours();"matchMedia"in e&&e.matchMedia("(prefers-color-scheme)")||(o=(e=a<=e._sunrise||a>=e._sunset?o:d)==o?d:o,s.body.classList.add(e),s.body.classList.remove(o))}(window,document); </script> <hy-push-state id="_pushState" replace-selector="#_main" link-selector="a[href]:not([href^='/pages/colindembovsky/assets/']):not(.external):not(.no-push-state)" script-selector="script" duration="500" hashchange ><div id="_navbar" class="navbar fixed-top"><div class="content"> <span class="sr-only">Jump to:</span><div class="nav-btn-bar"> <a id="_menu" class="nav-btn no-hover" href="#_drawer--opened"> <span class="sr-only">Navigation</span> <span class="icon-menu"></span> </a><div class="nav-span"></div></div></div></div><hr class="sr-only" hidden /><main id="_main" class="content layout-post" role="main" ><nav id="breadcrumbs" class="screen-only"><ul><li><a href="/pages/colindembovsky/">home</a><li> <span>/</span> <span>musings-on-reusable-workflows</span></ul></nav><article id="post-musings-on-reusable-workflows" class="page post mb6" role="article"><header><h1 class="post-title flip-project-title"> Musings on GitHub Actions Reusable Workflows</h1><div class="post-date"> <span class="ellipsis mr1"> <time datetime="2021-10-05T01:22:01+00:00">05 Oct 2021</time> on <a href="/pages/colindembovsky/tag/actions/" class="flip-title">actions</a>, <a href="/pages/colindembovsky/tag/build/" class="flip-title">build</a> </span></div><div class="img-wrapper lead aspect-ratio sixteen-nine flip-project-img"> <img src="/pages/colindembovsky/assets/images/2021/10/reuse.jpeg" alt="Musings on GitHub Actions Reusable Workflows" width="864" height="486" loading="lazy" /></div><p class="note-sm" > Newly released Reusable Workflows allows you to reuse workflows in your GitHub workflows. While this still has some limitations, it’s still better than copy/paste!</header><ol id="markdown-toc"><li><a href="#motivation-for-reusable-workflows" id="markdown-toc-motivation-for-reusable-workflows">Motivation for Reusable Workflows</a><li><a href="#limitations" id="markdown-toc-limitations">Limitations</a><li><a href="#making-a-workflow-reusable" id="markdown-toc-making-a-workflow-reusable">Making a Workflow Reusable</a><ol><li><a href="#add-the-call-trigger" id="markdown-toc-add-the-call-trigger">Add the Call Trigger</a><li><a href="#enable-actions-access-on-the-repo" id="markdown-toc-enable-actions-access-on-the-repo">Enable Actions Access on the Repo</a></ol><li><a href="#creating-a-reusable-dotnet-build-test-and-publish-workflow" id="markdown-toc-creating-a-reusable-dotnet-build-test-and-publish-workflow">Creating a Reusable DotNet Build, Test and Publish Workflow</a><ol><li><a href="#parameterize-the-platform" id="markdown-toc-parameterize-the-platform">Parameterize the Platform</a><li><a href="#parameterize-the-source-directory" id="markdown-toc-parameterize-the-source-directory">Parameterize the Source Directory</a><li><a href="#parameterize-running-tests" id="markdown-toc-parameterize-running-tests">Parameterize Running Tests</a><li><a href="#publish-the-app" id="markdown-toc-publish-the-app">Publish the App</a><li><a href="#putting-it-all-together" id="markdown-toc-putting-it-all-together">Putting it all together</a><li><a href="#invoking-the-workflow" id="markdown-toc-invoking-the-workflow">Invoking the Workflow</a></ol><li><a href="#array-hack" id="markdown-toc-array-hack">Array Hack</a><li><a href="#secrets" id="markdown-toc-secrets">Secrets</a><li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></ol><p><a href="https://docs.github.com/en/actions/learn-github-actions/reusing-workflows">Reusable workflows</a> have just been released to beta. Some level of reuse has been possible previously using <a href="https://docs.github.com/en/actions/creating-actions/creating-a-composite-action">Composite Actions</a>.<p>I wrote about Composite Actions and some of their limitations <a href="/github-composite-actions/">here</a>. In that post I also compared Composite Actions to Azure Pipeline <code class="language-plaintext highlighter-rouge">step</code> templates. Reusable workflows are akin to <code class="language-plaintext highlighter-rouge">job</code> templates in Azure Pipelines.<h2 id="motivation-for-reusable-workflows">Motivation for Reusable Workflows</h2><p>Reusable workflows allow you to centralize a set of common jobs. For example, you may have a common job for “Build a .NET application”. You may have a common job for “Deploy a Web App to Azure Web Apps”. Instead of each repo having the same set of steps for these common jobs, you can now create a centralized repo (or set of repos) that can be reused.<p>This keeps your workflows DRY (Don’t Repeat Yourself) and allows you to change a workflow in a single place. Since you can pin to a tag or branch when <em>referencing</em> a reusable workflow, you can ensure that you maintain backward compatibility.<p>Many organizations have a “DevOps Team”. I really don’t like this terminology, since I think DevOps should be everyone’s resposibility, not just fobbed off to some other team. However, in practice, many organizations have teams that write application code and have other teams that are focused on automating building, testing, securing and deploying that code. Reusable workflows is great for these teams.<p>For teams that are building their own automation, they can still benefit from a centralized location for reusable workflows. In this case, anyone could contribute to the workflows, where organizations with “DevOps teams” may want only the DevOps teams to be able to contribute to the workflows. In the end, this becomes a <em>process</em> question rather than a tooling question - you can set permissions (or lack of permissions) on the centralized repos however you like.<h2 id="limitations">Limitations</h2><p>There are still some limitations to reusable wofklows:<ol><li><del>Reusable workflows only run on <em>hosted</em> runners, not yet on <em>private</em> runners.</del> <strong>Update</strong>: Reusable workflows are supported on self-hosted runners now (10/14/2021)!<li>Reusable workflows cannot call other reusable workflows.<li><del>You cannot access job outputs from reusable workflows.</del> <strong>Update</strong>: You can now declare <code class="language-plaintext highlighter-rouge">outputs</code> to reusable workflows. These work just like <code class="language-plaintext highlighter-rouge">job</code> outputs and are available via <code class="language-plaintext highlighter-rouge">needs.&lt;reusable&gt;.outputs.&lt;output&gt;</code> format once you declare the output.<li><code class="language-plaintext highlighter-rouge">env</code> variables set in the calling workflow are not accessible to the called workflow.<li>The only parameter types that are supported are <code class="language-plaintext highlighter-rouge">string</code>, <code class="language-plaintext highlighter-rouge">number</code> and <code class="language-plaintext highlighter-rouge">boolean</code>. Arrays are not supported.<li>You cannot pass in steps to inject (like you can with Azure Pipelines templates).<li>Repos that contain reusable workflows must be either <code class="language-plaintext highlighter-rouge">internal</code> or <code class="language-plaintext highlighter-rouge">public</code>.<li>You cannot enforce use of a reusable workflow. In other words, there is no equivalent for <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops#extend-from-a-template">extends templates</a>.</ol><p>These limitations mean that reusable workflows are nowhere near as powerful as Azure Pipeline templates, but it’s a step in the right direction for Actions. At the very least, reusable workflows minimized copy/paste for simple scenarios.<h2 id="making-a-workflow-reusable">Making a Workflow Reusable</h2><h3 id="add-the-call-trigger">Add the Call Trigger</h3><p>Making a workflow reusable is not too hard - you just add a <code class="language-plaintext highlighter-rouge">workflow_call</code> trigger, with some optional <code class="language-plaintext highlighter-rouge">inputs</code> and <code class="language-plaintext highlighter-rouge">secrets</code>. The <code class="language-plaintext highlighter-rouge">workflow_call</code> trigger allows your workflow to be called by other workflows, and obviously you can pass values for the <code class="language-plaintext highlighter-rouge">inputs</code> and <code class="language-plaintext highlighter-rouge">secrets</code> using the <code class="language-plaintext highlighter-rouge">with</code> keyword, just like any other Action.<h3 id="enable-actions-access-on-the-repo">Enable Actions Access on the Repo</h3><p>The <code class="language-plaintext highlighter-rouge">workflow_call</code> trigger makes the workflow callable, but you still need to allow access. In the <code class="language-plaintext highlighter-rouge">Settings-&gt;Actions</code> tab of your repo, scroll to the bottom and enable the desired level of access:<p><img src="/assets/images/2021/10/actions-access.png" alt="Setting Actions Access level on a repo" class="center-image" /><p class="figcaption">Setting Actions Access level on a repo.<h2 id="creating-a-reusable-dotnet-build-test-and-publish-workflow">Creating a Reusable DotNet Build, Test and Publish Workflow</h2><p>Imagine you have a standard way of building and testing dotnet applications. Before reusable workflows, you would have had to copy/paste a workflow to every dotnet repo. Now you can set up a single workflow that can be reused. Let’s take a look at an example:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'simple-build.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet application</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">dotnet-version</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Version of dotnet to use</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">5.0.x</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup .NET</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-dotnet@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">dotnet-version</span><span class="pi">:</span> <span class="s">${{ inputs.dotnet-version }}</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Restore dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet restore</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet build --no-restore</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Test</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet test --no-build --verbosity normal</span>

</code></pre></div></div><p class="figcaption">A simple workflow to build a dotnet application.<p>Notes:<ol><li>We specify the <code class="language-plaintext highlighter-rouge">workflow_call</code> trigger in the <code class="language-plaintext highlighter-rouge">on</code> section to indicate that this is a reusable workflow.<li>We include an <code class="language-plaintext highlighter-rouge">input</code> called <code class="language-plaintext highlighter-rouge">dotnet-version</code> with some metadata as well as a default value of <code class="language-plaintext highlighter-rouge">5.0.x</code><li>The steps are really easy: <code class="language-plaintext highlighter-rouge">checkout</code> the code, setup the specified version of dotnet and then <code class="language-plaintext highlighter-rouge">run</code> <code class="language-plaintext highlighter-rouge">restore</code>, <code class="language-plaintext highlighter-rouge">build</code> and <code class="language-plaintext highlighter-rouge">test</code></ol><p>So far so good. Let’s enhance this workflow to add in some more functionality.<h3 id="parameterize-the-platform">Parameterize the Platform</h3><p>Let’s parameterized the <code class="language-plaintext highlighter-rouge">runs-on</code> so that we can pass in the hosted or private pool we want to run the workflow on:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">runs-on</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Platform to execute on</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">${{ inputs.runs-on }}</span>
    <span class="s">...</span>

</code></pre></div></div><p class="figcaption">Adding a <code class="language-plaintext highlighter-rouge">runs-on</code> input.<h3 id="parameterize-the-source-directory">Parameterize the Source Directory</h3><p>What if the project file isn’t in the root directory of the repo? Many teams put the app code into a folder called <code class="language-plaintext highlighter-rouge">src</code> or have a mono-repo with several apps in different folders. Not a problem - we can add a <code class="language-plaintext highlighter-rouge">project-folder</code> input and set that as the default working directory:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">project-folder</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">The folder containing the project to build</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">.</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">${{ inputs.runs-on }}</span>
    <span class="na">defaults</span><span class="pi">:</span>
      <span class="na">run</span><span class="pi">:</span>
        <span class="na">working-directory</span><span class="pi">:</span> <span class="s">${{ inputs.project-folder }}</span>
    <span class="s">...</span>

</code></pre></div></div><p class="figcaption">Adding a <code class="language-plaintext highlighter-rouge">project-folder</code> input.<h3 id="parameterize-running-tests">Parameterize Running Tests</h3><p>What if there are no tests to run or we don’t want to run them because they take too long? We can add a boolean parameter and skip the test step if this value is false:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">run-tests</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Run tests</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">boolean</span>
        <span class="na">default</span><span class="pi">:</span> <span class="no">true</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="s">...</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="s">...</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Test</span>
      <span class="na">if</span><span class="pi">:</span> <span class="s">${{ inputs.test }}</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet test --no-build --verbosity normal</span>

</code></pre></div></div><p class="figcaption">Adding a <code class="language-plaintext highlighter-rouge">run-tests</code> boolean input.<h3 id="publish-the-app">Publish the App</h3><p>What if we want to publish the compiled app, and specify the configuration and name of the published artifact? No problem.<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">publish-configuration</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Configuration to publish</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">Release</span>
        
      <span class="na">artifact-name</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Name of the artifact to upload</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">drop</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="s">...</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="s">...</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Publish</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet publish -c ${{ inputs.publish-configuration }} -o wdrop</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload a Build Artifact</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v2.2.2</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">${{ inputs.artifact-name }}</span>
        <span class="na">path</span><span class="pi">:</span> <span class="s">${{ inputs.project-folder }}/wdrop/**</span>
        <span class="na">if-no-files-found</span><span class="pi">:</span> <span class="s">error</span>

</code></pre></div></div><p class="figcaption">Adding steps and inputs for publishing.<h3 id="putting-it-all-together">Putting it all together</h3><p>The final workflow looks like this:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'completed-dotnet-build.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet application</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">runs-on</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Platform to execute on</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
        
      <span class="na">dotnet-version</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Version of dotnet to use</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">5.0.x</span>
      
      <span class="na">project-folder</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">The folder containing the project to build</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">.</span>
        
      <span class="na">run-tests</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Run tests</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">boolean</span>
        <span class="na">default</span><span class="pi">:</span> <span class="no">true</span>
      
      <span class="na">publish-configuration</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Configuration to publish</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">Release</span>
        
      <span class="na">artifact-name</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Name of the artifact to upload</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s">drop</span>
    
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">${{ inputs.runs-on }}</span>
    <span class="na">defaults</span><span class="pi">:</span>
      <span class="na">run</span><span class="pi">:</span>
        <span class="na">working-directory</span><span class="pi">:</span> <span class="s">${{ inputs.project-folder }}</span>
    
    <span class="na">steps</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Setup .NET</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-dotnet@v1</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">dotnet-version</span><span class="pi">:</span> <span class="s">${{ inputs.dotnet-version }}</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Restore dependencies</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet restore</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Build</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet build --no-restore</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Test</span>
        <span class="na">if</span><span class="pi">:</span> <span class="s">${{ inputs.test }}</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet test --no-build --verbosity normal</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Publish</span>
        <span class="na">run</span><span class="pi">:</span> <span class="s">dotnet publish -c ${{ inputs.publish-configuration }} -o wdrop</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Upload a Build Artifact</span>
        <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/upload-artifact@v2.2.2</span>
        <span class="na">with</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">${{ inputs.artifact-name }}</span>
          <span class="na">path</span><span class="pi">:</span> <span class="s">${{ inputs.project-folder }}/wdrop/**</span>
          <span class="na">if-no-files-found</span><span class="pi">:</span> <span class="s">error</span>

</code></pre></div></div><p class="figcaption">The final workflow.<h3 id="invoking-the-workflow">Invoking the Workflow</h3><p>Now that we have a reusable workflow, how do we invoke it? It’s pretty easy - almost like invoking an Action. In the code repo, we can add a new workflow that just invokes the centralized workflow we created:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'build.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Build application</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    <span class="na">branches</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">main</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build-ubuntu</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build app on Ubuntu</span>
    <span class="na">uses</span><span class="pi">:</span> <span class="s">octodemo/colind-reusable-workflows/.github/workflows/dotnetbuild.yml@main</span>
    <span class="na">with</span><span class="pi">:</span>
      <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
      <span class="na">run-tests</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">project-folder</span><span class="pi">:</span> <span class="s">src</span>
      <span class="na">artifact-name</span><span class="pi">:</span> <span class="s">drop-ubuntu</span>

</code></pre></div></div><p class="figcaption">Invoking the reusable workflow.<p>We declare a job (<code class="language-plaintext highlighter-rouge">build-ubuntu</code>) and then use <code class="language-plaintext highlighter-rouge">uses</code> to specify the job template. We use the format <code class="language-plaintext highlighter-rouge">owner/repo/path@label</code> to specify the exact location and version of the workflow. Then we use the <code class="language-plaintext highlighter-rouge">with</code> keyword to specify values for the <code class="language-plaintext highlighter-rouge">inputs</code>.<h2 id="array-hack">Array Hack</h2><p>I love being able to pass <code class="language-plaintext highlighter-rouge">stepLists</code> (or <code class="language-plaintext highlighter-rouge">jobLists</code>) in Azure Pipelines (see <a href="https://docs.microsoft.com/en-us/azure/devops/pipelines/process/templates?view=azure-devops#parameter-data-types">this doc</a>). This allows you to create generic templates that allow some customization of pre- or post-actions. You could have a template that build an app, allowing some post-build steps to copy files to a location or something along those lines. Unfortunately there is no equivalent in Actions. Even passing arrays of primitives requires a hack.<p>Let’s say you wanted to build the dotnet app on different platforms using a matrix, and you wanted to pass in a list of the platforms. There is no way to pass a list of values into a reusable workflow. But we can use <code class="language-plaintext highlighter-rouge">fromJSON</code> and pass in a JSON string:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'build-template.yml'</span>
<span class="na">nname</span><span class="pi">:</span> <span class="s">Build dotnet application</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">runs-on</span><span class="pi">:</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s">Platforms to execute on, in format of a string JSON array</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
        <span class="na">default</span><span class="pi">:</span> <span class="s1">'</span><span class="s">["ubuntu-latest"]'</span>
      <span class="s">...</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build dotnet app</span>
    <span class="na">strategy</span><span class="pi">:</span>
      <span class="na">matrix</span><span class="pi">:</span>
        <span class="na">runs-on</span><span class="pi">:</span> <span class="s">${{ fromJSON(inputs.runs-on) }}</span>
    
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">${{ matrix.runs-on }}</span>
    <span class="s">...</span>

</code></pre></div></div><p class="figcaption">Creating a JSON string input and parsing it for a matrix.<p>Then we pass in the JSON string array when we invoke the workflow:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'build-app.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Build Matrix</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_dispatch</span><span class="pi">:</span>
    
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">build-ubuntu</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">Build app on matrix</span>
    <span class="na">uses</span><span class="pi">:</span> <span class="s">octodemo/colind-reusable-workflows/.github/workflows/build-matrix.yml@main</span>
    <span class="na">with</span><span class="pi">:</span>
      <span class="na">runs-on</span><span class="pi">:</span> <span class="s1">'</span><span class="s">["ubuntu-latest",</span><span class="nv"> </span><span class="s">"windows-latest"]'</span>
      <span class="na">run-tests</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">project-folder</span><span class="pi">:</span> <span class="s">src</span>

</code></pre></div></div><p class="figcaption">Invoking a workflow with a JSON array parameter.<p>You can see the value that we pass to <code class="language-plaintext highlighter-rouge">runs-on</code>: it’s a JSON array that has been stringified.<p>This is definitely hacky, but it’s probably the only way to pass a list to a reusable workflow. And it won’t work for injecting steps.<h2 id="secrets">Secrets</h2><p>If you want to pass secrets to a reusable workflow, you should use the <code class="language-plaintext highlighter-rouge">secrets</code> keyword. These are really the same as inputs, but instead of being plaintext, they are treated as secrets. Here’s an example:<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'reusable.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">workflow_call</span><span class="pi">:</span>
    <span class="na">inputs</span><span class="pi">:</span>
      <span class="na">username</span><span class="pi">:</span>
        <span class="na">required</span><span class="pi">:</span> <span class="no">true</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
    <span class="na">secrets</span><span class="pi">:</span>
      <span class="na">token</span><span class="pi">:</span>
        <span class="na">required</span><span class="pi">:</span> <span class="no">true</span>
    
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">./.github/actions/some-authenticated-action@v1</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">username</span><span class="pi">:</span> <span class="s">${{ inputs.username }}</span>
        <span class="na">token</span><span class="pi">:</span> <span class="s">${{ secrets.token }}</span>      

</code></pre></div></div><p class="figcaption">Defining a <code class="language-plaintext highlighter-rouge">secret</code> input to a reusable workflow.<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># file: 'caller.yml'</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">Deploy</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">push</span><span class="pi">:</span>
    
<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">deploy</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">my-org/my-workflow-repo./.github/workflows/reusable.yml@v1</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">username</span><span class="pi">:</span> <span class="s">${{ github.actor }}</span>
      <span class="na">secrets</span><span class="pi">:</span>
        <span class="na">token</span><span class="pi">:</span> <span class="s">${{ github.token }}</span>      

</code></pre></div></div><p class="figcaption">Invoking a reusable workflow with a secret.<p>You can see how the secret <code class="language-plaintext highlighter-rouge">token</code> is passed using <code class="language-plaintext highlighter-rouge">secrets</code> under the <code class="language-plaintext highlighter-rouge">uses</code> keyword.<h1 id="conclusion">Conclusion</h1><p>Reusable Workflows are a great evolution for GitHub Actions. They can drastically reduce redundancy in your workflows and start paving the way for some centralized templates that can be used to standardize jobs in an org. While they have limitations, they are still powerful tools to add to your toolbelt.<p>Happy building!</article><hr class="dingbat related mb6" /><aside class="comments related" role="complementary"><h2 class="hr-bottom">Comments</h2><div id="giscus"><div></div></div><script> function toggle_giscus() { const c = document.body.classList; const dark = c.contains("dark-mode") || "_sunset" in window && !c.contains("light-mode") && matchMedia("(prefers-color-scheme: dark)").matches; const theme = dark ? "dark" : "light"; const scriptEl = document.createElement("script"); scriptEl.src = "https://giscus.app/client.js"; scriptEl.setAttribute("data-repo", "colindembovsky/colindembovsky.github.io"); scriptEl.setAttribute("data-repo-id", "MDEwOlJlcG9zaXRvcnk0MDczMjI3MjU="); scriptEl.setAttribute("data-category", "Giscussions"); scriptEl.setAttribute("data-category-id", "DIC_kwDOGEdAZc4B_F18"); scriptEl.setAttribute("data-mapping", "pathname"); scriptEl.setAttribute("data-reactions-enabled", "1"); scriptEl.setAttribute("data-emit-metadata", "colindembovsky/colindembovsky.github.io"); scriptEl.setAttribute("data-theme", theme); scriptEl.setAttribute("crossorigin", "anonymous"); const container = document.getElementById("giscus"); const old = container.firstElementChild; container.removeChild(old); container.appendChild(scriptEl); } document.addEventListener("hydejack-dark-mode-toggle", function() { toggle_giscus(); }); toggle_giscus(); </script></aside><aside class="other-projects related mb0" role="complementary"><h2>Related Posts</h2><div class="columns"><div class="column column-1-2"><article class="project-card"> <a href="/pages/colindembovsky/on-demand-ephemeral-self-hosted-runners/" class="no-hover no-print-link flip-project" tabindex="-1"><div class="project-card-img aspect-ratio sixteen-nine flip-project-img"> <img src="/pages/colindembovsky/assets/images/2021/10/self-hosted-runners/boom.jpeg" alt="On Demand Ephemeral Self-Hosted Runners" width="864" height="486" loading="lazy"/></div></a><h3 class="project-card-title flip-project-title"> <a href="/pages/colindembovsky/on-demand-ephemeral-self-hosted-runners/" class="flip-title">On Demand Ephemeral Self-Hosted Runners</a></h3><p class="project-card-text fine" property="disambiguatingDescription"> Do you need to deploy to private VNets using GitHub Actions, but don’t want to have to keep self-hosted runners running all the time? In this post I show you how you can use Ephemeral Runners to create on-demand self-hosted runners. <a class="fill-card no-hover" href="/pages/colindembovsky/on-demand-ephemeral-self-hosted-runners/" tabindex="-1"><span class="sr-only">Continue reading On Demand Ephemeral Self-Hosted Runners</span></a></article></div><div class="column column-1-2"><article class="project-card"> <a href="/pages/colindembovsky/azdo-create-work-item-action/" class="no-hover no-print-link flip-project" tabindex="-1"><div class="project-card-img aspect-ratio sixteen-nine flip-project-img"> <img src="/pages/colindembovsky/assets/images/posts/azdo.png" alt="Create Azure DevOps Work Item Action" width="864" height="486" loading="lazy"/></div></a><h3 class="project-card-title flip-project-title"> <a href="/pages/colindembovsky/azdo-create-work-item-action/" class="flip-title">Create Azure DevOps Work Item Action</a></h3><p class="project-card-text fine" property="disambiguatingDescription"> If you’re managing backlogs in Azure Boards but using GitHub Actions for CI/CD, you may have scenarios where you want to create Work Items from an Action. <a class="fill-card no-hover" href="/pages/colindembovsky/azdo-create-work-item-action/" tabindex="-1"><span class="sr-only">Continue reading Create Azure DevOps Work Item Action</span></a></article></div></div></aside><aside class="related mb4" role="complementary"><h2 class="hr-bottom">Random Posts</h2><ul class="related-posts"><li class="h4"> <a href="/pages/colindembovsky/dacpac-change-report-task-for-vsts-builds/" class="flip-title"><span>DacPac Change Report Task for VSTS Builds</span></a> <time class="faded fine" datetime="2016-08-05T22:57:24+00:00">05 Aug 2016</time><li class="h4"> <a href="/pages/colindembovsky/using-powershell-to-replace-config-settings-in-lab-management/" class="flip-title"><span>Using Powershell to Replace Config Settings in Lab Management</span></a> <time class="faded fine" datetime="2011-06-16T20:49:00+00:00">16 Jun 2011</time><li class="h4"> <a href="/pages/colindembovsky/fix-release-management-webdeploy-deployment-fails-access-denied/" class="flip-title"><span>Fix: Release Management WebDeploy Deployment Fails: Access Denied</span></a> <time class="faded fine" datetime="2014-02-07T18:17:00+00:00">07 Feb 2014</time></ul></aside><footer class="content" role="contentinfo"><hr/><p><small class="copyright">© 2021. All rights reserved. </small><hr class="sr-only"/></footer></main><hy-drawer id="_drawer" class="" side="left" threshold="10" noscroll ><header id="_sidebar" class="sidebar" role="banner"><div class="sidebar-bg sidebar-overlay" style="background-color:rgb(5,19,24);background-image:url(/pages/colindembovsky/assets/img/sidebar-bg.jpg)"></div><div class="sidebar-sticky"><div class="sidebar-about"> <a class="no-hover" href="/pages/colindembovsky/" tabindex="-1"> <img src="/pages/colindembovsky/assets/img/logo.png" class="avatar" alt="Colin's ALM Corner" width="120" height="120" loading="lazy" /> </a> <a class="sidebar-title" href="/pages/colindembovsky/"><h2 class="h1">Colin's ALM Corner</h2></a><p class=""> DevOpsology &amp; GitHub. <br /> <em>Opinions my own</em>.</div><nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span><ul><li> <a id="_drawer--opened" href="/pages/colindembovsky/tags/" class="sidebar-nav-item " > Tags </a><li> <a href="/pages/colindembovsky/about/" class="sidebar-nav-item " > About </a></ul></nav><div class="sidebar-social"> <span class="sr-only">Social:</span><ul><li> <a href="https://twitter.com/colindembovsky" title="Twitter" class="no-mark-external"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a><li> <a href="https://github.com/colindembovsky" title="GitHub" class="no-mark-external"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a><li> <a href="https://colinsalmcorner.com/feed.xml" title="RSS" class="no-mark-external"> <span class="icon-rss2"></span> <span class="sr-only">RSS</span> </a></ul></div></div></header></hy-drawer><hr class="sr-only" hidden /> </hy-push-state> <!--[if gt IE 10]><!----> <script nomodule>!function(){var t,n=document.createElement("script");!("noModule"in n)&&"onbeforeload"in n&&(t=!1,document.addEventListener("beforeload",function(e){if(e.target===n)t=!0;else if(!e.target.hasAttribute("nomodule")||!t)return;e.preventDefault()},!0),n.type="module",n.src=".",document.head.appendChild(n),n.remove())}(); </script> <script src="/pages/colindembovsky/assets/js/hydejack-9.1.4.js" type="module"></script> <script src="/pages/colindembovsky/assets/js/LEGACY-hydejack-9.1.4.js" nomodule defer></script> <script type="module"> if ('serviceWorker' in navigator) { /**/ navigator.serviceWorker.getRegistration() .then(r => r.unregister()) .catch(() => {}); /**/ } </script> <!--<![endif]--><div hidden><h2 class="sr-only">Templates (for web app):</h2><clap-config> <clap-text at="1">Keep going!</clap-text> <clap-text at="2">Keep going ×2!</clap-text> <clap-text at="3">Give me more!</clap-text> <clap-text at="5">Thank you, thank you</clap-text> <clap-text at="7">Far too kind!</clap-text> <clap-text at="10">Never gonna give me up?</clap-text> <clap-text at="14">Never gonna let me down?</clap-text> <clap-text at="20">Turn around and desert me!</clap-text> <clap-text at="30">You're an addict!</clap-text> <clap-text at="40">Son of a clapper!</clap-text> <clap-text at="50">No way</clap-text> <clap-text at="60">Go back to work!</clap-text> <clap-text at="70">This is getting out of <em>hand</em></clap-text> <clap-text at="80">Unbelievable</clap-text> <clap-text at="90">PREPOSTEROUS</clap-text> <clap-text at="100">I N S A N I T Y</clap-text> <clap-text at="185"><span style="font-family:monospace">FEED ME A STRAY CAT</span></clap-text> </clap-config> <template id="_animation-template"><div class="animation-main fixed-top"><nav id="breadcrumbs" class="screen-only"><ul></ul></nav><div class="content"><div class="page"></div></div></div></template> <template id="_loading-template"><div class="loading nav-btn fr"> <span class="sr-only">Loading…</span> <span class="icon-cog"></span></div></template> <template id="_error-template"><div class="page"><h1 class="page-title">Error</h1><p class="lead"> Sorry, an error occurred while loading <a class="this-link" href=""></a>.</div></template> <template id="_permalink-template"> <a href="#" class="permalink"> <span class="sr-only">Permalink</span> <span class="content-hash"></span> </a> </template> <template id="_cookies-banner-template"><div id="_cookies-banner" class="navbar fixed-bottom CookiesOK"><div class="content"><div class="nav-btn-bar"> <small class="faded"> <span>This site uses cookies. <a href="/cookies-policy/">Cookies Policy</a>. </span> <button id="_cookies-ok" class="btn btn-primary btn-sm">Okay</button> </small></div></div></div></template> <template id="_dark-mode-template"> <button id="_dark-mode" class="nav-btn no-hover" > <span class="sr-only">Dark Mode</span> <span class="icon-brightness-contrast"></span> </button> </template> <template id="_search-template"> <button id="_search" class="nav-btn no-hover"> <label class="sr-only" for="_search-input">Search</label> <span class="icon-search"></span> </button><div id="_search-box"><div class="nav-btn"> <span class="icon-search"></span></div><input id="_search-input" type="search" class="form-control form-control-lg nav-btn" placeholder="Type something…" /> <button type="reset" class="nav-btn no-hover"> <span class="sr-only">Close</span> <span class="icon-cross"></span> </button></div><div id="_hits"></div></template></div></html>
